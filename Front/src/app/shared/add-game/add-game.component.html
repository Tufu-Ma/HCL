<app-header-navbar></app-header-navbar>
<div class="container py-4">

  <!-- Title -->
  <div class="d-flex align-items-center justify-content-between mb-3">
    <div>
      <h2 class="h4 mb-0">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÉ‡∏´‡∏°‡πà</h2>
      <small class="text-muted">‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡∏° ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î ‚Äú‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Å‡∏°‚Äù ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á</small>
    </div>
  </div>

  <!-- Add Game Card -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <form [formGroup]="form" (ngSubmit)="submit()">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏° <span class="text-danger">*</span></label>
            <input type="text" formControlName="name" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô PUBG">
            <div class="form-text">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏°‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ö‡∏ô‡∏Å‡∏≤‡∏£‡πå‡∏î</div>
          </div>

          <div class="col-md-6">
            <label class="form-label">Slug</label>
            <input type="text" formControlName="slug" class="form-control" placeholder="‡πÄ‡∏ä‡πà‡∏ô pubg">
            <div class="form-text">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏á‡∏Å‡πå‡∏™‡∏±‡πâ‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</div>
          </div>

          <div class="col-md-8">
            <label class="form-label">Cover URL</label>
            <input type="url" formControlName="coverurl" class="form-control" placeholder="https://...">
            <div class="form-text">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏£‡∏π‡∏õ‡∏™‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏µ‡πà‡∏¢‡∏°‡∏à‡∏±‡∏ï‡∏∏‡∏£‡∏±‡∏™</div>
          </div>

          <div class="col-md-4">
            <label class="form-label">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏†‡∏≤‡∏û‡∏õ‡∏Å</label>
            <div class="ratio ratio-1x1 rounded border d-flex align-items-center justify-content-center bg-light overflow-hidden">
              <img
              [src]="form.value.coverurl || 'assets/testBG.jpg'"
              alt="preview"
              class="w-100 h-100 object-fit-cover"
              (error)="onImgError($event, 'assets/testBG.jpg')">
            </div>
          </div>

          <div class="col-12">
            <label class="form-label">Description</label>
            <textarea formControlName="description" class="form-control" rows="3" placeholder="‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏±‡πâ‡∏ô ‡πÜ"></textarea>
          </div>
        </div>

        <div class="d-flex gap-2 mt-3">
          <button class="btn btn-primary" type="submit" [disabled]="form.invalid || submitting">
            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏Å‡∏°
          </button>
          <button type="button" class="btn btn-outline-secondary" (click)="form.reset()">‡∏•‡πâ‡∏≤‡∏á‡∏ü‡∏≠‡∏£‡πå‡∏°</button>
        </div>
      </form>
    </div>
  </div>

  <!-- List Header -->
  <div class="d-flex align-items-center justify-content-between mb-2">
    <h2 class="h5 mb-0">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h2>
    <span class="text-muted">{{ games.length || 0 }} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
  </div>

  <!-- Empty State -->
  <div *ngIf="!games.length" class="card shadow-sm">
    <div class="card-body text-center py-5">
      <h5 class="mb-1">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏Å‡∏°</h5>
      <p class="text-muted mb-0">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Å‡∏°‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏≤‡∏Å‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</p>
    </div>
  </div>

  <!-- Grid of Cards -->
  <div class="row g-3 mt-1">
    <div class="col-12 col-sm-6 col-md-4 col-lg-3" *ngFor="let g of games; trackBy: trackById">
      <div class="card game-card h-100 shadow-sm" style="cursor:pointer;" (click)="goDetail(g)">

        <!-- Cover -->
        <div class="position-relative">
          <img
          [src]="g.coverurl || 'assets/testBG.jpg'"
          class="card-img-top"
          alt="cover"
          style="height: 160px; object-fit: cover;"
          (error)="onImgError($event, 'assets/testBG.jpg')">


          <span class="badge position-absolute top-0 end-0 m-2"
                [class.bg-success]="g.active"
                [class.bg-secondary]="!g.active">
            {{ g.active ? 'Active' : 'Inactive' }}
          </span>
        </div>

        <!-- Body -->
        <div class="card-body py-3">
          <h6 class="card-title text-truncate mb-1">{{ g.name }}</h6>
          <div class="text-muted small text-truncate">
            <strong>Slug:</strong> {{ g.slug || '-' }}
          </div>
          <div class="small mt-2 text-truncate-2">
            {{ g.description || '‚Äî' }}
          </div>
        </div>

        <!-- Footer controls -->
        <div class="card-footer bg-white border-0 pt-0 pb-3">
          <div class="d-flex justify-content-between gap-2">
            <button
              type="button"
              class="btn btn-sm btn-outline-warning"
              (click)="toggleActive(g); $event.stopPropagation()"
              [disabled]="togglingId === g.id">
              {{ g.active ? '‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡πÄ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' }}
            </button>

            <button
              type="button"
              class="btn btn-sm btn-outline-danger"
              (click)="deleteGame(g); $event.stopPropagation()"
              [disabled]="deletingId === g.id">
              ‡∏•‡∏ö
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>

</div>
