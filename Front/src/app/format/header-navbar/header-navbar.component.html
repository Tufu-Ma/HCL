<nav class="topbar">
  <div class="topbar__inner">
    <!-- Burger (mobile) -->
    <button class="hamburger" (click)="toggleDrawer()" aria-label="Open menu">
      <span></span><span></span><span></span>
    </button>

    <!-- Logo -->
    <a class="brand" routerLink="/home" aria-label="Home">
      <img src="/assets/logo.png" alt="logo" />
    </a>

    <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å (desktop/tablet) -->
    <ul class="menu">
      <li><a routerLink="/termgame" class="text-nowrap">‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏° UID</a></li>
      <li><a routerLink="/giftcard" class="text-nowrap">‡∏ö‡∏±‡∏ï‡∏£‡∏Å‡∏≥‡∏ô‡∏±‡∏•/‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏°</a></li>
      <li><a routerLink="/subscription" class="text-nowrap">‡∏ï‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏≠‡∏û</a></li>
      <li><a routerLink="/promotion" class="text-nowrap">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</a></li>
      <li><a routerLink="/about-me" class="text-nowrap">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a></li>
    </ul>

    <!-- ‡∏Ç‡∏ß‡∏≤: search + profile/login (desktop/tablet) -->
    <div class="right">
      <form class="search" role="search" (submit)="$event.preventDefault()">
        <input
          type="search"
          placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..."
          name="search"
          autocomplete="off"
          [(ngModel)]="searchTerm"
          (input)="onSearch($event)"
        />
      </form>

      <!-- ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà login -->
      <a *ngIf="!isLoggedIn" class="btn-login" routerLink="/login">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>

      <!-- login ‡πÅ‡∏•‡πâ‡∏ß -->
      <div *ngIf="isLoggedIn" class="position-relative">
<button
  class="btn-profile"
  (click)="toggleMenu()"
  aria-haspopup="menu"
  [attr.aria-expanded]="menuOpen"
>

          <img
            [src]="userProfileImage || 'assets/default-profile.png'"
            alt="profile"
            class="profile-pic"
            (error)="onImgError($event)"
          />
          <span class="username ms-2">{{ username || '‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ' }}</span>
        </button>

        <!-- dropdown ‡πÄ‡∏°‡∏ô‡∏π‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå (desktop/tablet) -->
        <ul
          *ngIf="menuOpen"
          class="dropdown-menu show position-absolute end-0 mt-2"
          style="display:block; z-index:1050;"
          role="menu"
        >
          <li><a class="dropdown-item" routerLink="/profile">‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå</a></li>

          <!-- ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ user -->
          <li *ngIf="!isAdmin"><a class="dropdown-item" routerLink="/history">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</a></li>

          <!-- ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ admin -->
          <li *ngIf="isAdmin"><a class="dropdown-item text-warning" routerLink="/dashboard">‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</a></li>
          <li *ngIf="isAdmin"><a class="dropdown-item text-warning" routerLink="/addgame">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏°</a></li>

          <li><hr class="dropdown-divider" /></li>
          <li><button class="dropdown-item text-danger" (click)="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button></li>
        </ul>
      </div>
    </div>
  </div>
</nav>

<!-- Drawer Backdrop (mobile) -->
<div class="drawer-backdrop" [class.show]="drawerOpen" (click)="closeDrawer()"></div>

<!-- Drawer (mobile) -->
<aside class="drawer" [class.open]="drawerOpen" [attr.aria-hidden]="!drawerOpen">
  <div class="drawer__header">
    <a class="brand" routerLink="/home" aria-label="Home">
      <img src="/assets/logo.png" alt="logo" />
    </a>
    <button class="drawer-close" (click)="closeDrawer()" aria-label="Close menu">‚úï</button>
  </div>

  <nav class="drawer-menu">
    <a (click)="navigateAndClose('/termgame')">‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏° UID</a>
    <a (click)="navigateAndClose('/giftcard')">‡∏ö‡∏±‡∏ï‡∏£‡∏Å‡∏≥‡∏ô‡∏±‡∏•/‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏ï‡∏¥‡∏°‡πÄ‡∏Å‡∏°</a>
    <a (click)="navigateAndClose('/subscription')">‡∏ï‡πà‡∏≠‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏≠‡∏û</a>
    <a (click)="navigateAndClose('/promotion')">‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</a>
    <a (click)="navigateAndClose('/about-me')">‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡πÄ‡∏£‡∏≤</a>

    <ng-container *ngIf="isLoggedIn; else drawerLogin">
      <button class="btn-logout" (click)="logout()">üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
    </ng-container>

    <ng-template #drawerLogin>
      <hr />
      <a (click)="navigateAndClose('/login')">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</a>
    </ng-template>
  </nav>
</aside>
